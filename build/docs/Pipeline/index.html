<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Pipeline" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Pipeline | What works</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docs/Pipeline"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Pipeline | What works"><meta data-rh="true" name="description" content="alt text"><meta data-rh="true" property="og:description" content="alt text"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docs/Pipeline"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/Pipeline" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/Pipeline" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.264bfde1.css">
<script src="/assets/js/runtime~main.9d58e25b.js" defer="defer"></script>
<script src="/assets/js/main.f281da62.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Documenation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Conclusions">SAM2 Video</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/TheCleverIdiott/Segment-Anything" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Conclusions">Conclusions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Inference">Inference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Model Setup">Model Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Ongoing Research">Ongoing Research</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/Pipeline">Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/SAM2 on Images">SAM2 on Images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Usable Result">Usable Result</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Results from SAM Video Testing</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Pipeline</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Pipeline</h1></header><p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/pipeline-c46c1636cbf4bef9e3999bd30e4ef2fb.png" width="3164" height="1220" class="img_ev3q">
</p><p>Proposed Optimal pipeline</p><p></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pipeline-components"><strong>Pipeline Components</strong><a href="#pipeline-components" class="hash-link" aria-label="Direct link to pipeline-components" title="Direct link to pipeline-components">​</a></h3>
<ul>
<li>Video Input</li>
<li>Frame Extraction</li>
<li>Object Detection</li>
<li>Region of Interest (ROI) Extraction</li>
<li>Segment Anything Model (SAM) Processing</li>
<li>Mask Selection and Refinement</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="process-flow"><strong>Process Flow</strong><a href="#process-flow" class="hash-link" aria-label="Direct link to process-flow" title="Direct link to process-flow">​</a></h3>
<p><strong>1. Video Input</strong><br>
<!-- -->The pipeline begins with a video input.</p>
<p><strong>2. Frame Extraction</strong><br>
<!-- -->Method: OpenCV (CV2)<br>
<!-- -->Output: Array of frames</p>
<p><strong>3. Object Detection</strong><br>
<!-- -->Model: YOLO<br>
<!-- -->Purpose: Detect ROI containing object X<br>
<!-- -->Input: Each frame from the array<br>
<!-- -->Output: ROI region</p>
<p><strong>4. ROI Extraction</strong><br>
<!-- -->The detected ROI is extracted and passed to the next stage.</p>
<p><strong>5. SAM Processing</strong><br>
<!-- -->Input: ROI region<br>
<!-- -->Output: Generated image segments (all possible masks)</p>
<p><strong>6. Mask Selection and Refinement</strong><br>
<!-- -->All possible masks are generated by SAM.<br>
<!-- -->Masks are sorted from largest to smallest area.<br>
<!-- -->The largest mask area inside the ROI is identified as the target object.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="explanation"><strong>Explanation</strong><a href="#explanation" class="hash-link" aria-label="Direct link to explanation" title="Direct link to explanation">​</a></h3>
<p>In its natural state SAM segments everything on from the given image. So if feeded an image without an aim or a possible ROI it will segment most objects from that image. Little to no support is there to use SAM to detect a particular image or mask in an image. The official documentation shows that a each mask generates a an unique point for itself. This unique point is the center of the mask. When prompting we click near an image (or we can say near its mask) the closest to the point we click the changes of that mask being selected increases. This is the process os selecting an image via sam. But to select a particular object with high accuracy mare than one prompting is required which is not possible for a live video stream.</p>
<p>Instead we can have an object detection model that is trained to detect a particular object. This will return is a bounding box around that object. Like the image shown below.<br>
<!-- -->We can clearly see that the “object” is occupying the largest space in this box. We cam feed this object into the SAM model to segment. The sam model will again sement everyhtng in he image but the mask with the largest area will be the object we require. As shown in the below figure.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-considerations"><strong>Key Considerations</strong><a href="#key-considerations" class="hash-link" aria-label="Direct link to key-considerations" title="Direct link to key-considerations">​</a></h3>
<p><strong>SAM Behavior</strong><br>
<!-- -->SAM naturally segments all objects in a given image.<br>
<!-- -->Without specific guidance, SAM will segment most objects in the frame.</p>
<p><strong>Object Selection Challenge</strong><br>
<!-- -->Official SAM documentation suggests using unique points (mask centers) for prompting.<br>
<!-- -->Clicking near an image/mask increases the likelihood of selecting that mask.<br>
<!-- -->Accurate object selection often requires multiple prompts, which is impractical for live video streams.</p>
<p>Solution: Combination with Object Detection</p>
<p>An object detection model (e.g., YOLO) is used to identify and localize the target object.<br>
<!-- -->The object detection model provides a bounding box around the target.<br>
<!-- -->This bounding box serves as the ROI for SAM processing.<br>
<!-- -->The target object typically occupies the largest area within this ROI.</p>
<p><strong>Final Segmentation</strong><br>
<!-- -->SAM segments everything within the ROI.<br>
<!-- -->The mask with the largest area within the ROI is selected as the final segmentation of the target object.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-find-the-lagest-area-of-the-mask-by-sorting-the-masks">How to find the lagest area of the mask by sorting the masks<a href="#how-to-find-the-lagest-area-of-the-mask-by-sorting-the-masks" class="hash-link" aria-label="Direct link to How to find the lagest area of the mask by sorting the masks" title="Direct link to How to find the lagest area of the mask by sorting the masks">​</a></h2>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/image-9-7ff5b6d8d886b37a431377ee75f4de72.png" width="1148" height="394" class="img_ev3q"></p>
<p>Sorted Masks</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/image-10-795842a6c461f9ec3b027f88c8d1209c.png" width="1106" height="1032" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/image-11-9a468343a61139051cdc7c2a58b00e68.png" width="1290" height="1320" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="we-can-clearly-see-that-the-first-object-the-mask-with-most-area-and-is-the-required-object">We can clearly see that the first object the mask with most area and is the required object.<a href="#we-can-clearly-see-that-the-first-object-the-mask-with-most-area-and-is-the-required-object" class="hash-link" aria-label="Direct link to We can clearly see that the first object the mask with most area and is the required object." title="Direct link to We can clearly see that the first object the mask with most area and is the required object.">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">masks = [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mask[&#x27;segmentation&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for mask</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    in sorted(sam2_result, key=lambda x: x[&#x27;area&#x27;], reverse=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sv.plot_images_grid(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    images=masks[:16],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    grid_size=(4, 4),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    size=(12, 12)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Ongoing Research"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Ongoing Research</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/SAM2 on Images"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SAM2 on Images</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pipeline-components" class="table-of-contents__link toc-highlight"><strong>Pipeline Components</strong></a></li><li><a href="#process-flow" class="table-of-contents__link toc-highlight"><strong>Process Flow</strong></a></li><li><a href="#explanation" class="table-of-contents__link toc-highlight"><strong>Explanation</strong></a></li><li><a href="#key-considerations" class="table-of-contents__link toc-highlight"><strong>Key Considerations</strong></a></li><li><a href="#how-to-find-the-lagest-area-of-the-mask-by-sorting-the-masks" class="table-of-contents__link toc-highlight">How to find the lagest area of the mask by sorting the masks</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>